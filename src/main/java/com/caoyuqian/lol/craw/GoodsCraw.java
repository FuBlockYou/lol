package com.caoyuqian.lol.craw;import com.caoyuqian.lol.entity.goods.Goods;import com.caoyuqian.lol.utils.HttpUtil;import org.jsoup.nodes.Document;import org.jsoup.nodes.Element;import org.jsoup.select.Elements;import org.springframework.stereotype.Component;import java.io.IOException;import java.util.ArrayList;import java.util.Date;import java.util.List;/** * 装备物品查询 */@Componentpublic class GoodsCraw {    /**     * 分部分爬取     * @param start     * @param end     * @return     * @throws IOException     */    public List<Goods> crawByPage(int start, int end) throws IOException {        List<String> urls = getUrl();        List<String> urls1 = urls.subList(start,end) ;        List<Goods> goodss = new ArrayList<>();        for (String s: urls1        ) {            goodss.add(crawGoods(s));        }        return  goodss;    }    /**     * 获取装备物品的url     * @return     * @throws IOException     */    public List<String> getUrl() throws IOException {        String url = "https://www.wanplus.com/lol/skill/item";        Document document = HttpUtil.get(url);        Element element = document.getElementsByClass("skill-listall").get(0);        //爬取所有装备的详情页url        List<String> urls = new ArrayList<>();        Elements a = element.getElementsByTag("a");        String baseUrl = "https://www.wanplus.com";        for (Element e: a        ) {            String href = e.attr("href");            href = baseUrl + href;            urls.add(href);        }        return urls;    }    public List<Goods> craw() throws IOException {        List<String> urls = getUrl();        List<Goods> goodss = new ArrayList<>();        for (String s: urls        ) {            goodss.add(crawGoods(s));        }        return  goodss;    }    public  Goods crawGoods(String url) throws IOException {        Document document1 = HttpUtil.get(url);        Elements e = document1.getElementsByClass("item-detail");        Element img = e.select("img").get(0);        //装备图片        String src = img.attr("src");        //装备名称        String name = img.attr("alt");        //装备价格        Elements cons = document1.getElementsByClass("cons");        String price = cons.text();        //装备属性        Elements att = document1.getElementsByClass("item-attr");        String atts = att.text();        //装备被动        Elements attr = document1.getElementsByClass("attr-desc");        String attrs = attr.text();        return  Goods.builder()                .name(name)                .price(price)                .attribute(atts)                .effect(attrs)                .imageUrl(src)                .build();    }}